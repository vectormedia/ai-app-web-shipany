# ShipAny 应用访问指南

## 📋 目录

- [用户控制台（User Console）](#用户控制台user-console)
- [后台管理（Admin）](#后台管理admin)

---

# 用户控制台（User Console）

## 用户端访问地址

开发环境（本地）：

- 英文版本：[http://localhost:3000](http://localhost:3000)
- 中文版本：[http://localhost:3000/zh](http://localhost:3000/zh)

生产环境：

- 英文版本：`https://你的域名`
- 中文版本：`https://你的域名/zh`

## 用户端功能模块

### 🏠 首页与公共页面

| 页面 | 路径 | 功能说明 |
|------|------|----------|
| 🏠 首页 | `/` | 应用首页、产品介绍 |
| 💰 定价页 | `/pricing` | 查看订阅计划和价格 |
| 📝 博客 | `/blog` | 博客文章列表 |
| 🎨 展示案例 | `/showcases` | 作品展示 |

### 🤖 AI 功能（需要登录）

| 功能 | 路径 | 功能说明 |
|------|------|----------|
| 🖼️ AI 图片生成 | `/ai-image-generator` | AI 生成图片 |
| 🎵 AI 音频生成 | `/ai-audio-generator` | AI 生成音频 |
| 🎼 AI 音乐生成 | `/ai-music-generator` | AI 生成音乐 |
| 🎬 AI 视频生成 | `/ai-video-generator` | AI 生成视频 |
| 💬 AI 聊天机器人 | `/ai-chatbot` | AI 对话助手 |

### 💬 聊天功能

| 页面 | 路径 | 功能说明 |
|------|------|----------|
| 💬 聊天 | `/chat` | 聊天界面 |

### 📊 用户活动（需要登录）

访问入口：`/activity`

| 模块 | 路径 | 功能说明 |
|------|------|----------|
| 📊 活动概览 | `/activity` | 用户活动主页 |
| 🤖 AI 任务记录 | `/activity/ai-tasks` | 查看我的 AI 生成记录 |
| 💬 聊天记录 | `/activity/chats` | 查看我的聊天历史 |
| 💭 反馈记录 | `/activity/feedbacks` | 我提交的反馈 |

### ⚙️ 用户设置（需要登录）

访问入口：`/settings`

| 模块 | 路径 | 功能说明 |
|------|------|----------|
| ⚙️ 设置主页 | `/settings` | 用户设置概览 |
| 👤 个人资料 | `/settings/profile` | 编辑个人信息 |
| 🔐 安全设置 | `/settings/security` | 密码、两步验证等 |
| 💳 账单管理 | `/settings/billing` | 订阅管理、支付方式 |
| 💰 支付记录 | `/settings/payments` | 查看支付历史 |
| 📄 发票管理 | `/settings/invoices` | 下载发票 |
| 🎯 积分余额 | `/settings/credits` | 查看和购买积分 |
| 🔑 API 密钥 | `/settings/apikeys` | 生成和管理 API 密钥 |

### 🔐 认证页面

| 页面 | 路径 | 功能说明 |
|------|------|----------|
| 🔐 登录 | `/auth/signin` | 用户登录 |
| ✨ 注册 | `/auth/signup` | 用户注册 |
| 🔒 忘记密码 | `/auth/forgot-password` | 密码重置 |

---

# 后台管理（Admin）

## 后台访问地址

开发环境（本地）：

- 英文版本：[http://localhost:3000/admin](http://localhost:3000/admin)
- 中文版本：[http://localhost:3000/zh/admin](http://localhost:3000/zh/admin)

生产环境：

- 英文版本：`https://你的域名/admin`
- 中文版本：`https://你的域名/zh/admin`

## 后台功能模块

### 核心管理

| 模块 | 路径 | 功能说明 |
|------|------|----------|
| 📊 仪表板 | `/admin` | 后台首页，数据概览 |
| ⚙️ 系统设置 | `/admin/settings` | OAuth、支付、存储等系统配置 |

### 用户与权限

| 模块 | 路径 | 功能说明 |
|------|------|----------|
| 👥 用户管理 | `/admin/users` | 用户列表、编辑、删除 |
| 🔑 角色管理 | `/admin/roles` | 角色创建和权限分配 |
| 🔐 权限管理 | `/admin/permissions` | 系统权限配置（RBAC） |

### 支付与订阅

| 模块 | 路径 | 功能说明 |
|------|------|----------|
| 💳 订阅管理 | `/admin/subscriptions` | 用户订阅计划管理 |
| 💰 支付记录 | `/admin/payments` | 支付交易记录查询 |
| 🎯 积分管理 | `/admin/credits` | 用户积分系统管理 |

### AI 功能

| 模块 | 路径 | 功能说明 |
|------|------|----------|
| 🤖 AI 任务 | `/admin/ai-tasks` | AI 生成任务记录（图片、音频、视频等） |
| 💬 聊天记录 | `/admin/chats` | 聊天机器人对话记录 |

### 内容管理

| 模块 | 路径 | 功能说明 |
|------|------|----------|
| 📝 文章管理 | `/admin/posts` | 博客/文章内容管理 |
| 🏷️ 分类管理 | `/admin/categories` | 内容分类设置 |

### 开发者工具

| 模块 | 路径 | 功能说明 |
|------|------|----------|
| 🔐 API 密钥 | `/admin/apikeys` | API 密钥生成和管理 |

## 访问权限说明

### 首次访问注意事项

1. **需要登录**
   - 必须先注册账号并登录
   - 登录页面：`/auth/signin`

2. **需要管理员权限**
   - 普通用户无法访问后台
   - 需要在数据库中设置用户角色为管理员
   - 如果没有权限会跳转到：`/admin/no-permission`

3. **权限验证机制**
   - 项目使用 RBAC（基于角色的访问控制）
   - 权限配置位置：`src/core/rbac/`
   - 可以在后台设置模块中配置细粒度权限

## 创建管理员账号

### 方法一：通过数据库直接设置

```sql
-- 查询用户 ID
SELECT id, email FROM users WHERE email = 'your-email@example.com';

-- 更新用户角色为管理员（假设 role_id=1 是管理员角色）
UPDATE users SET role_id = 1 WHERE email = 'your-email@example.com';
```

### 方法二：通过 Drizzle Studio

```bash
# 打开数据库管理界面
pnpm db:studio

# 然后在界面中修改用户的角色
```

## 重要配置说明

### OAuth 配置（在后台设置中）

支持的 OAuth 提供商：
- Google
- GitHub
- Discord
- Microsoft
- 等等...

配置位置：`/admin/settings` - OAuth 设置页面

### 支付配置（在后台设置中）

支持的支付提供商：
- Stripe
- PayPal
- Creem

配置位置：`/admin/settings` - 支付设置页面

### 存储配置（在后台设置中）

支持的存储服务：
- AWS S3
- Cloudflare R2
- 本地存储

配置位置：`/admin/settings` - 存储设置页面

## 架构说明

### 后台路由结构

```
src/app/[locale]/
├── (admin)/          # 后台管理布局
│   ├── layout.tsx    # 后台布局（侧边栏、顶栏等）
│   └── admin/        # 后台页面
│       ├── page.tsx  # 仪表板首页
│       ├── users/    # 用户管理
│       ├── settings/ # 系统设置
│       └── ...       # 其他管理模块
```

### 权限控制

- 使用 Better-auth 进行身份认证
- 使用 RBAC 进行权限管理
- 权限配置存储在数据库中，可在后台动态调整

## 常见问题

### Q1: 无法访问后台，显示 403 或跳转到登录页？
**A**: 检查是否已登录，且账号是否有管理员权限。

### Q2: 如何给第一个用户设置管理员权限？
**A**: 通过数据库直接修改，或使用 `pnpm db:studio` 打开 Drizzle Studio 修改。

### Q3: OAuth/支付配置在哪里？
**A**: 在 `/admin/settings` 页面中配置，配置会保存在数据库中（不是环境变量）。

### Q4: 后台支持哪些语言？
**A**: 目前支持中文和英文，通过 URL 前缀切换（`/admin` 或 `/zh/admin`）。

## 相关文档

- [项目启动指令和流程](./分析/9-项目启动指令和流程.md)
- [CLAUDE.md](../CLAUDE.md) - 项目架构说明
- 认证系统：`src/core/auth/`
- 权限系统：`src/core/rbac/`
- 数据库 Schema：`src/core/db/schema/`

---

最后更新：2025-12-07
